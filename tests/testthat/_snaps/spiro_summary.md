# stepwise summary works

       step_number duration load     VO2    VCO2     VE HR PetO2 PetCO2 VO2_rel
    1            0       60  0.0  500.19  411.74  13.03 NA    NA     NA    7.58
    2            1      300  2.0 1860.92 1585.75  39.87 NA    NA     NA   28.20
    3            2      300  2.4 2097.82 1805.27  44.63 NA    NA     NA   31.79
    4            3      300  2.8 2413.01 2122.17  52.63 NA    NA     NA   36.56
    5            4      300  3.2 2710.68 2319.93  57.19 NA    NA     NA   41.07
    6            5      300  3.6 3048.75 2684.87  67.45 NA    NA     NA   46.19
    7            6      300  4.0 3404.02 3026.70  75.91 NA    NA     NA   51.58
    8            7      300  4.4 3724.37 3383.64  88.36 NA    NA     NA   56.43
    9            8      300  4.8 4223.82 3993.55 106.44 NA    NA     NA   64.00
    10           9      300  5.2 4573.91 4488.36 127.54 NA    NA     NA   69.30
           RE  RER  CHO   FO
    1      NA 0.82 0.27 0.15
    2  234.97 0.85 1.27 0.46
    3  220.73 0.86 1.51 0.49
    4  217.62 0.88 1.95 0.48
    5  213.91 0.86 1.89 0.65
    6  213.86 0.88 2.47 0.60
    7  214.90 0.89 2.90 0.62
    8  213.75 0.91 3.50 0.56
    9  222.21 0.95 4.68 0.37
    10 222.12 0.98 5.82 0.12

---

       step_number duration load     VO2    VCO2     VE HR PetO2 PetCO2 VO2_rel
    1          0.0       60 0.00  547.39  585.82  16.55 NA    NA     NA    8.29
    2          0.5      120 2.80 2383.28 2165.22  54.17 NA    NA     NA   36.11
    3          1.0       30 2.95 2368.57 2174.85  56.12 NA    NA     NA   35.89
    4          2.0       30 3.10 2500.92 2267.64  57.12 NA    NA     NA   37.89
    5          3.0       30 3.25 2642.22 2420.95  62.21 NA    NA     NA   40.03
    6          4.0       30 3.40 2733.49 2429.99  61.08 NA    NA     NA   41.42
    7          5.0       30 3.55 2906.27 2607.17  62.86 NA    NA     NA   44.03
    8          6.0       30 3.70 2937.92 2730.87  68.05 NA    NA     NA   44.51
    9          7.0       30 3.85 3057.89 2825.01  69.84 NA    NA     NA   46.33
    10         8.0       30 4.00 3128.19 2910.31  72.35 NA    NA     NA   47.40
    11         9.0       30 4.15 3358.05 3102.21  75.06 NA    NA     NA   50.88
    12        10.0       30 4.30 3421.28 3195.42  78.60 NA    NA     NA   51.84
    13        11.0       30 4.45 3656.19 3466.31  84.95 NA    NA     NA   55.40
    14        12.0       30 4.60 3707.31 3572.52  86.48 NA    NA     NA   56.17
    15        13.0       30 4.75 3843.92 3683.04  90.61 NA    NA     NA   58.24
    16        14.0       30 4.90 4125.40 4044.04 100.25 NA    NA     NA   62.51
    17        15.0       30 5.05 4181.26 4116.53 101.74 NA    NA     NA   63.35
    18        16.0       30 5.20 4339.68 4314.96 107.98 NA    NA     NA   65.75
    19        17.0       30 5.35 4433.75 4524.51 115.75 NA    NA     NA   67.18
    20        18.0       30 5.50 4610.26 4669.10 121.60 NA    NA     NA   69.85
    21        19.0       30 5.65 4729.04 4858.56 129.87 NA    NA     NA   71.65
    22        20.0       30 5.80 4885.39 5062.96 137.60 NA    NA     NA   74.02
    23        21.0       30 5.95 4990.24 5194.91 142.00 NA    NA     NA   75.61
    24        22.0       30 6.10 4877.32 5128.64 144.21 NA    NA     NA   73.90
    25        23.0       10 6.25 4393.91 4662.32 142.36 NA    NA     NA   66.57
           RE  RER  CHO   FO
    1      NA 1.07 0.92 0.00
    2  214.94 0.91 2.24 0.36
    3  202.75 0.92 2.33 0.32
    4  203.72 0.91 2.33 0.38
    5  205.30 0.92 2.58 0.36
    6  203.02 0.89 2.32 0.50
    7  206.73 0.90 2.58 0.49
    8  200.51 0.93 3.04 0.33
    9  200.57 0.92 3.09 0.38
    10 197.49 0.93 3.25 0.35
    11 204.34 0.92 3.39 0.42
    12 200.92 0.93 3.61 0.36
    13 207.48 0.95 4.10 0.30
    14 203.52 0.96 4.42 0.21
    15 204.36 0.96 4.49 0.25
    16 212.61 0.98 5.23 0.11
    17 209.08 0.98 5.39 0.09
    18 210.75 0.99 5.78 0.05
    19 209.28 1.02 6.44 0.00
    20 211.67 1.01 6.54 0.00
    21 211.36 1.03 7.02 0.01
    22 212.70 1.04 7.45 0.01
    23 211.79 1.04 7.72 0.00
    24 201.91 1.05 7.78 0.00
    25 177.53 1.06 7.20 0.00

# spiro_summary returns message when shortening interval

    Code
      spiro_summary(ramp_data, interval = 300)
    Message
      for load steps, interval was set to 30 seconds
      for step 23, interval was set to length of step (10 seconds)
    Output
         step_number duration load     VO2    VCO2     VE HR PetO2 PetCO2 VO2_rel
      1          0.0       60 0.00  547.39  585.82  16.55 NA    NA     NA    8.29
      2          0.5      120 2.80 2383.28 2165.22  54.17 NA    NA     NA   36.11
      3          1.0       30 2.95 2368.57 2174.85  56.12 NA    NA     NA   35.89
      4          2.0       30 3.10 2500.92 2267.64  57.12 NA    NA     NA   37.89
      5          3.0       30 3.25 2642.22 2420.95  62.21 NA    NA     NA   40.03
      6          4.0       30 3.40 2733.49 2429.99  61.08 NA    NA     NA   41.42
      7          5.0       30 3.55 2906.27 2607.17  62.86 NA    NA     NA   44.03
      8          6.0       30 3.70 2937.92 2730.87  68.05 NA    NA     NA   44.51
      9          7.0       30 3.85 3057.89 2825.01  69.84 NA    NA     NA   46.33
      10         8.0       30 4.00 3128.19 2910.31  72.35 NA    NA     NA   47.40
      11         9.0       30 4.15 3358.05 3102.21  75.06 NA    NA     NA   50.88
      12        10.0       30 4.30 3421.28 3195.42  78.60 NA    NA     NA   51.84
      13        11.0       30 4.45 3656.19 3466.31  84.95 NA    NA     NA   55.40
      14        12.0       30 4.60 3707.31 3572.52  86.48 NA    NA     NA   56.17
      15        13.0       30 4.75 3843.92 3683.04  90.61 NA    NA     NA   58.24
      16        14.0       30 4.90 4125.40 4044.04 100.25 NA    NA     NA   62.51
      17        15.0       30 5.05 4181.26 4116.53 101.74 NA    NA     NA   63.35
      18        16.0       30 5.20 4339.68 4314.96 107.98 NA    NA     NA   65.75
      19        17.0       30 5.35 4433.75 4524.51 115.75 NA    NA     NA   67.18
      20        18.0       30 5.50 4610.26 4669.10 121.60 NA    NA     NA   69.85
      21        19.0       30 5.65 4729.04 4858.56 129.87 NA    NA     NA   71.65
      22        20.0       30 5.80 4885.39 5062.96 137.60 NA    NA     NA   74.02
      23        21.0       30 5.95 4990.24 5194.91 142.00 NA    NA     NA   75.61
      24        22.0       30 6.10 4877.32 5128.64 144.21 NA    NA     NA   73.90
      25        23.0       10 6.25 4393.91 4662.32 142.36 NA    NA     NA   66.57
             RE  RER  CHO   FO
      1      NA 1.07 0.92 0.00
      2  214.94 0.91 2.24 0.36
      3  202.75 0.92 2.33 0.32
      4  203.72 0.91 2.33 0.38
      5  205.30 0.92 2.58 0.36
      6  203.02 0.89 2.32 0.50
      7  206.73 0.90 2.58 0.49
      8  200.51 0.93 3.04 0.33
      9  200.57 0.92 3.09 0.38
      10 197.49 0.93 3.25 0.35
      11 204.34 0.92 3.39 0.42
      12 200.92 0.93 3.61 0.36
      13 207.48 0.95 4.10 0.30
      14 203.52 0.96 4.42 0.21
      15 204.36 0.96 4.49 0.25
      16 212.61 0.98 5.23 0.11
      17 209.08 0.98 5.39 0.09
      18 210.75 0.99 5.78 0.05
      19 209.28 1.02 6.44 0.00
      20 211.67 1.01 6.54 0.00
      21 211.36 1.03 7.02 0.01
      22 212.70 1.04 7.45 0.01
      23 211.79 1.04 7.72 0.00
      24 201.91 1.05 7.78 0.00
      25 177.53 1.06 7.20 0.00

# input is validated

    'interval' must be greater or equal to 1

---

    'quiet' must be either TRUE or FALSE

---

    'exclude' must be either TRUE or FALSE

---

    Data does not contain an exercise protocol

